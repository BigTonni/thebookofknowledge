# Сценарий разработки

(?)Возможны два варианта работы с git:
* Git-flow
* Github-flow

(?)Выбор из них осуществляется, исходя из сложности проекта.


Работа с любым репозиторием начинается с его клонирования на рабочую машину.
Делается это очень простым образом:

```
git clone ssh://user@domain.tld/repo.git <name>
```

Параметр `name` носит необязательный характер. Если данный параметр не задан, то
название папки будет равняться названию репозитория.

Затем мы создаем локальную ветку для внесения изменений. Для проекта на стадии
до релиза:
```
git checkout master
```

На стадии после релиза:
```
git checkout development
```

Следующие команды одинаковы для обоих стадий:
```
git pull
git checkout -b <branch-name>
git push origin <branch-name>
```

После внесение изменений в коде и выполнения задачи или ее части, добавляем
изменения в общий репозиторий:

```
git add -A
git commit
git push
```

`git add -A` — подготавливаем все изменённых файлы к отправке в репозиторий
`git commit` — после того как файлы готовы, нам необходимо их закоммитить. Этой
командой мы вызовем текстовый редактор, в котором мы можем набрать
сообщение к коммиту. Альтернативой можно рассматривать команду `git commit -m
<message>`, где <message> будет являться сообщением к коммиту.
Про правильные сообщения к коммитам можно прочитать в соответствующем разделе.
`git push` — собственно отправка изменений.

Из этой простой последовательности могут быть исключения. Одно из них — если вы
работаете вместе с кем-то над одной веткой изменений.

```
git add -A
git stash
git pull
git stash pop
git commit
git push
```

`git add -A` — подготавливаем все изменённые файлы

`git stash` — прячем сделанные изменения. При этом они убираются из рабочей
ветки, но никуда не деваются. Это позволяет без проблем осуществить следующий
этап.

`git pull` — проверяем, есть ли в удаленном репозитории какие либо изменения,
которых ещё нет у нас локально

`git stash pop` — достаем спрятанные изменения и удаляем их копию из stash

`git commit` — так как все изменения уже подготовлены, мы можем без проблем их
закомитить.

`git push` — отправляем изменения на сервер.

Этот вариант помогает избежать нежалательных конфликтов при слиянии изменений.

В целом разработка по такому сценарию, носит следующий вид:

1. От текущей основной ветки разработки создается feature branch (ветку изменений)
2. Вносятся необходимые изменения и создается новый код на локальной машине
3. Отправляюися изменения на сервер (push)
4. После завершения разработки нового функционала в github создается pull request
5. После проверки pull request, осуществляется merge в основную векту
6. …
7. PROFIT!

##Общие моменты

* Избегайте включать в общий репозиторий файлы специфичные для вашего рабочего
  окружения (это касается, например, файлов .idea)
* Не стоит включать реальные имя пользователя и пароль, в файл parameters.yml.dist
  и в похожие файлы, которые хранятся в общем репозитории
* После того как работа в feature branch была закончена следует удалить
  как локальную копию этой ветки, так и ветку, которая остается на сервере.
  Сделать это можно с помощью следующих команд: `git branch -D <branch-name>`
  для удаления локальной ветки, `git push origin :<branch-name>` для удаления
  ветки в удалённом репозитории

## Дополнительная литература

* [Understanding the GitHub Flow](https://guides.github.com/introduction/flow/)
* [Git-flow](http://nvie.com/posts/a-successful-git-branching-model/)
* [GitHub Flow](https://habrahabr.ru/post/189046/)
